<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        /* ê³µí†µ ë ˆì´ì•„ì›ƒ */
        body.app-body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }

        .page {
            max-width: 960px;
            margin: 0 auto;
            padding: 24px 16px 40px;
        }

        .page__header {
            margin-bottom: 16px;
        }

        .page__title {
            margin: 0 0 8px;
            font-size: 24px;
        }

        .page__back {
            font-size: 14px;
            margin-bottom: 24px;
        }

        .page__back a {
            text-decoration: none;
            color: #555;
        }

        .page__back a:hover {
            text-decoration: underline;
        }

        /* ì„¹ì…˜ ê³µí†µ */
        .section {
            margin-bottom: 32px;
        }

        .section__title {
            margin: 0 0 12px;
            font-size: 18px;
        }

        /* ê²€ìƒ‰ ì˜ì—­ */
        .search {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .search__input {
            flex: 1;
            min-width: 220px;
            padding: 8px 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        .search__button {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            background-color: #007bff;
            color: #fff;
            font-size: 14px;
        }

        .search__button:hover {
            background-color: #0056b3;
        }

        /* í¼ ê³µí†µ */
        .form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form__group {
            display: flex;
            flex-direction: column;
            gap: 6px;
            max-width: 520px;
        }

        .form__label {
            font-size: 14px;
            font-weight: 600;
        }

        .form__input,
        .form__textarea {
            padding: 8px 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form__textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form__submit {
            align-self: flex-start;
            padding: 10px 18px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            background-color: #28a745;
            color: #fff;
            font-size: 15px;
            font-weight: 600;
        }

        .form__submit:hover {
            background-color: #1e7e34;
        }

        /* í…Œì´ë¸” ì˜ì—­ */
        .table-wrapper {
            background-color: #fff;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #ddd;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .table thead {
            background-color: #f0f0f0;
        }

        .table th,
        .table td {
            padding: 8px 10px;
            border-bottom: 1px solid #e0e0e0;
            text-align: left;
        }

        .table th:first-child,
        .table td:first-child,
        .table th:nth-child(2),
        .table td:nth-child(2) {
            text-align: center;
            width: 60px;
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .cover-thumb {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 4px;
        }

        .empty-state {
            font-size: 14px;
            background-color: #fff;
            padding: 16px 14px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }

        .empty-state a {
            color: #007bff;
            text-decoration: none;
        }

        .empty-state a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body class="app-body">
    <div class="page">
        <!-- ìƒë‹¨ í—¤ë” -->
        <header class="page__header">
            <h1 class="page__title">ìƒˆ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°</h1>
            <p class="page__back">
                <a href="{{ url_for('index') }}">â† í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
            </p>
        </header>

        <!-- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê¸°ë³¸ ì •ë³´ + ë…¸ë˜ ì„ íƒ (POST) -->
        <form method="POST" action="{{ url_for('create_playlist') }}" class="form">
            <!-- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê¸°ë³¸ ì •ë³´ -->
            <section class="section">
                <h2 class="section__title">í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì •ë³´</h2>

                <div class="form__group">
                    <label class="form__label" for="playlist-title">ì œëª©</label>
                    <input
                        id="playlist-title"
                        type="text"
                        name="title"
                        class="form__input"
                        required
                    >
                </div>

                <div class="form__group">
                    <label class="form__label" for="playlist-description">ì„¤ëª…</label>
                    <textarea
                        id="playlist-description"
                        name="description"
                        class="form__textarea"
                        rows="3"
                    ></textarea>
                </div>
            </section>

            <!-- ğŸ” ë…¸ë˜ ê²€ìƒ‰ (GET í¼ì€ ë°–ì—, í•˜ì§€ë§Œ ìœ„ì¹˜ëŠ” ë…¸ë˜ ì„ íƒ ìœ„) -->
        </form>

        <section class="section">
            <h2 class="section__title">ë…¸ë˜ ê²€ìƒ‰</h2>
            <form method="GET" action="{{ url_for('create_playlist') }}" class="search">
                <input
                    type="text"
                    name="q"
                    class="search__input"
                    placeholder="ì œëª©/ì•„í‹°ìŠ¤íŠ¸/ì•¨ë²” ê²€ìƒ‰"
                    value="{{ search_query or '' }}"
                >
                <button type="submit" class="search__button">ê²€ìƒ‰</button>
            </form>
        </section>

        <!-- ë‹¤ì‹œ POST í¼ ì‹œì‘: ë…¸ë˜ ì„ íƒ + ì €ì¥ -->
        <form method="POST" action="{{ url_for('create_playlist') }}" class="form">
            <input type="hidden" name="title" value="{{ request.form.get('title', '') }}">
            <input type="hidden" name="description" value="{{ request.form.get('description', '') }}">

            <section class="section">
                <h2 class="section__title">ë…¸ë˜ ì„ íƒ</h2>

                {% if songs and songs|length > 0 %}
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>ì»¤ë²„</th>
                                    <th>ì œëª©</th>
                                    <th>ì•„í‹°ìŠ¤íŠ¸</th>
                                    <th>ì•¨ë²”</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for s in songs %}
                                    <tr>
                                        <td>
                                            <input
                                                type="checkbox"
                                                name="song_ids"
                                                value="{{ s['song_id'] }}"
                                            >
                                        </td>
                                        <td>
                                            {% if s['cover_url'] %}
                                                <img
                                                    src="{{ s['cover_url'] }}"
                                                    alt="cover"
                                                    class="cover-thumb"
                                                >
                                            {% endif %}
                                        </td>
                                        <td>{{ s['title'] }}</td>
                                        <td>{{ s['artist'] or '-' }}</td>
                                        <td>{{ s['album'] or '-' }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <button type="submit" class="form__submit">
                        í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì €ì¥
                    </button>
                {% else %}
                    <div class="empty-state">
                        í‘œì‹œí•  ë…¸ë˜ê°€ ì—†ìŠµë‹ˆë‹¤.
                        <a href="{{ url_for('manage_songs') }}">ë…¸ë˜ ê´€ë¦¬ í˜ì´ì§€</a>ì—ì„œ ë…¸ë˜ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.
                    </div>
                {% endif %}
            </section>
        </form>
    </div>
</body>
</html>
